[toc]

# 字符串相关知识

## 一、字符串长度

```lua
s = "abcd"
print(#s)        -- 4（4个英文字符）
s = "字符串"
print(#s)        -- 12（中文字符在UTF-8中占3字节，共4个中文字符×3=12字节）
```

> **注意**：Lua 中 `#` 操作符返回字符串的**字节数**，中文字符在 UTF-8 编码下占 3 字节。

---

## 二、多行字符串

```lua
-- 方式1：转义字符
print("123\n123")  -- 输出：123\n123（换行效果）

-- 方式2：[[...]]（推荐）
s = [[ Lua学习]]
print(s)           -- 输出： Lua学习（保留原始格式）
```

> `[[...]]` 语法会保留字符串中的所有空白和换行，是多行字符串的标准写法。

---

## 三、字符串拼接

```lua
-- 使用 .. 连接
print("123" .. "456")  -- 输出：123456

-- 使用 string.format 格式化
print(string.format("Lua,学习%d年半", 2))  -- 输出：Lua,学习2年半
```

> **格式化占位符**：
>
> - `%d`：整数
> - `%f`：浮点数
> - `%s`：字符串
> - `%a`：任意字符

---

## 四、类型转换为字符串

```lua
a = true
print(tostring(a))  -- 输出：true
print(tostring(123)) -- 输出：123
```

> `tostring()` 是将任意类型转换为字符串的通用方法。

---

## 五、字符串公共方法

### 1. 大小写转换
```lua
str = "abcDEFG"
print(string.upper(str))  -- 输出：ABCDEFG
print(string.lower(str))  -- 输出：abcdefg
```

### 2. 字符串反转
```lua
print(string.reverse(str))  -- 输出：GFEDcba
```

### 3. 字符串查找
```lua
print(string.find(str, "DEF"))  -- 输出：4 6（匹配位置）
```

### 4. 字符串截取
```lua
print(string.sub(str, 3, 4))  -- 输出：cD（从第3个字符到第4个字符）
```

### 5. 字符串重复
```lua
print(string.rep(str, 2))  -- 输出：abcDEFGabcDEFG
```

### 6. 字符串替换
```lua
print(string.gsub(str, "DE", "**"))  -- 输出：abc**FG 1 (第二个参数1表示替换了多少次)
```

### 7. 字符与ASCII码转换
```lua
a = string.byte("Lua", 1)  -- 获取第一个字符的ASCII码
print(a)                   -- 输出：76（'L'的ASCII码）
print(string.char(a))      -- 输出：L（ASCII码转字符）
```

## 六、关键特性总结



| 操作类型   | 方法/符号       | 说明                      |
| ---------- | --------------- | ------------------------- |
| 字符串长度 | `#`             | 返回字节数（中文占3字节） |
| 多行字符串 | `[[...]]`       | 保留原始格式，无转义需求  |
| 字符串拼接 | `..`            | 基础拼接操作符            |
| 格式化输出 | `string.format` | 类似C语言的printf格式化   |
| 类型转换   | `tostring()`    | 通用类型转换方法          |
| 字符串处理 | `string.*`      | 提供完整的字符串操作API   |
| 字符编码   | `string.byte`   | 字符转ASCII码             |
| ASCII编码  | `string.char`   | ASCII码转字符             |

> **重要提示**：Lua 中字符串索引**从1开始**（不同于C语言的0开始），字符串是**不可变**的（所有操作返回新字符串）。