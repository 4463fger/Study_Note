[toc]

# LuaEnv

## 1. 创建与初始化

```csharp
LuaEnv env = new LuaEnv();
```

- **唯一性**：建议在Unity中保持`LuaEnv`实例的唯一性,只有一个解析器即可
- **作用**：创建Lua运行环境，是执行Lua代码的基础

## 2. 关键方法

| 方法                       | 作用              | 使用场景             |
| -------------------------- | ----------------- | -------------------- |
| `DoString(string luaCode)` | 执行Lua代码字符串 | 直接执行简单Lua语句  |
| `Tick()`                   | 执行Lua垃圾回收   | 每帧调用或场景切换时 |
| `Dispose()`                | 释放Lua环境资源   | 不再需要时调用       |

## 3. 基本使用示例

```csharp
// 创建Lua环境
LuaEnv env = new LuaEnv();

// 执行Lua代码
env.DoString("print('Hello World')");

// 执行Lua脚本（通过require）
// 默认寻找脚本路径在Resources
// 因为通过Resources.Load取加载，后缀得加一个txt,bytes才能识别
env.DoString("require('Main')");

// 每帧执行垃圾回收
env.Tick();

// 释放资源
env.Dispose();
```

## 4. 使用注意事项

1. **垃圾回收**：
   - `Tick()`应每帧调用（或在逻辑间隔中调用）
   - 避免频繁创建/销毁Lua环境
2. **资源释放**：
   - 必须调用`Dispose()`释放Lua环境
   - 未释放可能导致内存泄漏

> 💡 提示：`LuaEnv`是``XLua`的核心类，后续所有Lua交互都通过它进行。